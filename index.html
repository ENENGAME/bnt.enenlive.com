<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta property="og:title" content="BNT官網">
  <meta property="og:description" content="BRANDNEWTEAM，簡稱:BNT。">
  <meta property="og:image" content="PNG/mini.jpg">
  <meta property="og:url" content="https://enentsel.github.io/FFTET/ENEN.html">
  <meta property="og:type" content="website">
  <link rel="icon" href="https://enentsel.github.io/BNT/BNT.ico" type="image/x-icon">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="./BNT_files/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
  <script src="./BNT_files/bootstrap.bundle.min.js.下載" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="./BNT_files/BNT.css">
  <title>BNT 官網</title>
  <style>
    body {
      background-image: url("./PNG/BNT底圖.png");
      background-repeat: cover;
      background-size: 100% auto;
    }
  </style>
</head>
<body>
  <header>  
    <nav class="navbar navbar-expand-lg navbar-light">
      <div class="container-fluid">
        <a class="navbar-brand" href="https://line.me/ti/p/Sa2N3zx6kF"><img class="logo" height="80px" src="PNG/BNT1.png"></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#linkbar">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="linkbar">
          <ul class="navbar-nav me-auto">
            <li class="nav-item"><a class="nav-link" href="https://www.tiktok.com/@alpaca_0412?_t=8jam2bvQ2US&_r=1" target="_blank" style="color: #F8DD00;">TikTok</a></li>         
            <li class="nav-item"><a class="nav-link" href="https://lin.ee/qfE7c08" target="_blank" style="color: #F8DD00;">官方賴@392dwztt</a></li>
            <li class="nav-item"><a class="nav-link" href="https://reurl.cc/WRRLn9" target="_blank" style="color: #F8DD00;">審核社群</a></li>
            <li class="nav-item"><a class="nav-link" href="https://enentsel.github.io/BNT/FFTPL.html" target="_blank" style="color: #F8DD00;">BNT X 江林</a></li>
          </ul>
        </div>
      </div>
    </nav>  
  </header>

  <div class="container_1">  
    <div class="index">
      <img src="PNG/BNT.png" alt="標識">
    </div>
  </div>  

  <div class="container">
    <div class="photos">
      <img class="record" src="PNG/001.png" alt="戰隊介紹">
      <img src="PNG/戰隊介紹.jpg" width="1920" height="1080" alt="頻道主題">
      <div class="00">　</div>
      <div class="00">　</div>
      
      <div class="00">　</div>
      <img class="record" src="PNG/002.png" alt="計分規則">
      <img src="PNG/戰隊規範.png" width="1920" height="1080" alt="積分表">
      <div class="00">　</div>
      
    </div>
    <div class="Text"></div>
  </div>
  <!DOCTYPE html>
  <html lang="en">
  <head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      .container {
        background-color: rgba(189, 189, 189, 0.6);
        padding: 20px;
        border-radius: 10px;
      }
      .search-container {
        display: flex;
        align-items: center;
      }
      .search-input {
        width: 80%;
      }
      .search-button {
        flex: 1;
      }
      .page-title {
  text-align: center;
  font-family: Arial, sans-serif;
  font-size: 30px;
  font-weight: 1000; /* 新增字體粗度，使用數值 */
  margin-bottom: 40px;
  background-size: contain;
  background-repeat: no-repeat;
  padding: 30px;
  color: rgb(255, 255, 255);
}


      .player-info p {
        color: rgb(255, 255, 255);
      }
      .player-info img {
        width: 100%;
        max-width: 640px;
        height: auto;
        margin: 5px;
      }
    </style>
  </head>
  <body>
    <h3 class="page-title">玩家資訊查詢</h3>
    <div class="container">
      <div class="row">
        <div class="col">
          <form id="search-form" class="form-inline" onsubmit="searchPlayers(); return false;">
            <div class="search-container">
              <img src="./PNG/BNT1.png" alt="Search Icon" width="48" height="48">
              <input class="search-input" type="text" id="searchtext" name="searchtext" placeholder="請輸入UID">
              <button class="search-button btn btn-primary" type="submit">搜尋</button>
            </div>
          </form>
          <div id="search-results" class="mt-3"></div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      const apiKey = 'AIzaSyDCpZh3hJxy5VEDXBTqkSkauHuR99CXIvk';
      const spreadsheetId = '1Bfl9dA41ouI3RpNRSpcHrEOz7Hqthg-BMTskFSkqRRU'; // 固定的試算表ID
      let sheetName = '合併!A:L'; // 初始化为空
  
      function selectSheet(name) {
        sheetName = name;
        document.getElementById('searchtext').value = ''; // 清空搜索框
        document.getElementById('search-results').innerHTML = ''; // 清空搜索结果
      }
  
      function searchPlayers() {
        if (!sheetName) {
          alert('請先選擇工作表');
          return;
        }
        const searchText = document.getElementById('searchtext').value;
        const apiUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${sheetName}?key=${apiKey}`;
  
        axios.get(apiUrl)
          .then(response => {
            const values = response.data.values;
            if (values) {
              const searchResults = filterAndSortData(values, searchText);
              displaySearchResults(searchResults);
            } else {
              document.getElementById('search-results').innerHTML = '<p>沒有找到任何數據。</p>';
            }
          })
          .catch(error => {
            console.error('搜尋失敗:', error);
            document.getElementById('search-results').innerHTML = '<p>搜尋失敗。</p>';
          });
      }
  
      function filterAndSortData(data, searchText) {
        const filteredData = data.filter(row => row[3] === searchText);
        const playerMap = new Map();
        filteredData.forEach(row => {
          const name = row[0];
          const time = new Date(row[0]); // 確保 row[0] 是可解析的日期
          if (!playerMap.has(name) || playerMap.get(name).time < time) {
            playerMap.set(name, { time, data: row });
          }
        });
        const sortedData = Array.from(playerMap.values()).map(entry => entry.data);
        return sortedData;
      }
  
      function displaySearchResults(results) {
        const searchResultsContainer = document.getElementById('search-results');
        searchResultsContainer.innerHTML = '';
        if (results.length === 0) {
          searchResultsContainer.innerHTML = '<p>戰隊中無此位選手。</p>';
        } else {
          results.forEach(player => {
            const playerInfo = document.createElement('div');
            playerInfo.classList.add('player-info');
  
            const gameName = document.createElement('p');
            gameName.textContent = '遊戲名：' + (player[2] || '無');
  
            const uidDisplay = document.createElement('p');
            uidDisplay.textContent = 'UID：' + (player[3] || '無');

            const position = document.createElement('p');
            position.textContent = '職位：' + (player[4] || '無');

            const nickname = document.createElement('p');
            nickname.textContent = '暱稱：' + (player[5] || '無');

            const playerType = document.createElement('p');
            playerType.textContent = '玩家類型：' + (player[6] || '無');

            const commendation = document.createElement('p');
            commendation.textContent = '嘉獎：' + (player[7] || '無');

            const warning = document.createElement('p');
            warning.textContent = '警告：' + (player[8] || '無');
  
            const joinDate = document.createElement('p');
            joinDate.textContent = '進BNT日期：' + (player[9] || '無');
  
            const duration = document.createElement('p');
            duration.textContent = '累積時長：' + (player[10] || '無');
  
            const imgUrl1 = player[0];
            const img1 = document.createElement('img');
            img1.src = imgUrl1 || 'https://via.placeholder.com/640x296';
            img1.alt = '玩家圖片1';
  
            const imgUrl2 = player[1];
            const img2 = document.createElement('img');
            img2.src = imgUrl2 || 'https://via.placeholder.com/640x296';
            img2.alt = '玩家圖片2';
  
            playerInfo.appendChild(gameName);
            playerInfo.appendChild(uidDisplay);
            playerInfo.appendChild(position);
            playerInfo.appendChild(nickname);
            playerInfo.appendChild(playerType);
            playerInfo.appendChild(commendation);
            playerInfo.appendChild(warning);
            playerInfo.appendChild(joinDate);
            playerInfo.appendChild(duration);
            playerInfo.appendChild(img1);
            playerInfo.appendChild(img2);
  
            searchResultsContainer.appendChild(playerInfo);
          });
        }
      }
    </script>
  </body>
  </html>
  <br><br>
  <div class="Footer">
    <p>©2024 BNT 保留所有權利。</p>
  </div>
</body>
</html>
